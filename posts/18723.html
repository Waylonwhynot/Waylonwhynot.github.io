<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Go-14-结构体 | YouNeed</title><meta name="keywords" content="Go"><meta name="author" content="Waylon Yan"><meta name="copyright" content="Waylon Yan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Go 结构体">
<meta property="og:type" content="article">
<meta property="og:title" content="Go-14-结构体">
<meta property="og:url" content="http://yoursite.com/posts/18723.html">
<meta property="og:site_name" content="YouNeed">
<meta property="og:description" content="Go 结构体">
<meta property="og:locale">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png">
<meta property="article:published_time" content="2021-08-15T13:11:36.000Z">
<meta property="article:modified_time" content="2025-08-04T15:41:26.895Z">
<meta property="article:author" content="Waylon Yan">
<meta property="article:tag" content="Go">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/posts/18723"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Go-14-结构体',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-04 23:41:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">266</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">40</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">25</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Catagroires</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">YouNeed</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Catagroires</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Go-14-结构体</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-08-15T13:11:36.000Z" title="Created 2021-08-15 21:11:36">2021-08-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-04T15:41:26.895Z" title="Updated 2025-08-04 23:41:26">2025-08-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Go/">Go</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Go-14-结构体"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Go 结构体</p>
<a id="more"></a>

<h1 id="Go语言结构体"><a href="#Go语言结构体" class="headerlink" title="Go语言结构体"></a>Go语言结构体</h1><p><img src="https://cdn.jsdelivr.net/gh/Waylonwhynot/whatyouneed_blog_pic@main/pic/struct_summary.png" alt="struct_summary"></p>
<p>我们前面介绍的数组 只能保存同一种类型的数据, 当我们需要记录多种不同类型的数据时，我们该怎么办?</p>
<p>结构体就是用于解决这个问题的, 结构体是由一系列具有相同类型或不同类型的数据构成的数据集合, 方便容量我们的任意类型的数据</p>
<h2 id="结构体的定义"><a href="#结构体的定义" class="headerlink" title="结构体的定义"></a>结构体的定义</h2><p>例如 我们用于描述一个人的特征, 如果我们单独使用变量描述应该如何描述:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    name          <span class="keyword">string</span></span><br><span class="line">    age           <span class="keyword">int</span></span><br><span class="line">    gender        <span class="keyword">string</span></span><br><span class="line">    weight        <span class="keyword">uint</span></span><br><span class="line">    favoriteColor []<span class="keyword">string</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>有了结构体过后 我们就可以把这些变量包装起来，做成一个结构体类型:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name          <span class="keyword">string</span></span><br><span class="line">    Age           <span class="keyword">int</span></span><br><span class="line">    Gender        <span class="keyword">string</span></span><br><span class="line">    Weight        <span class="keyword">uint</span></span><br><span class="line">    FavoriteColor []<span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面我们介绍下结构体(struct)的定义语法:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> identifier <span class="keyword">struct</span> &#123;</span><br><span class="line">    field1 type1</span><br><span class="line">    field2 type2</span><br><span class="line">    …</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="keyword">type</span> T <span class="keyword">struct</span> &#123; a, b <span class="keyword">int</span> &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>type: 定义自定义类型的关键字, 比如 type myType string</li>
<li>identifier: 我们定义的这种类型的名称</li>
<li>struct: 表明我们定义的类型是一种struct类型, struct类型就是由一组字段构成的集合</li>
<li>{field1 type1 field2 type2 … }: 结构体成员定义</li>
</ul>
<p>可以看出其中struct 类型很关键, 他表明我们制定以的这种类型是一种结构体类型, 这种类型是有成员变量构成的, 像一个容器</p>
<p>由于成员是我们自己定义的，所以结构体有高度的灵活性, Go中不少功能依赖于结构</p>
<p>理论上，每个字段都是有具有唯一性的名字的，比如我们定义2个同名的成员变量是会报错的:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name          <span class="keyword">string</span></span><br><span class="line">    Name          <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但如果确定某个字段不会被使用，可以将其名称定义为空标识符_来丢弃掉</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    _          <span class="keyword">string</span></span><br><span class="line">    Name          <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每个字段都有类型，可以是任意类型，包括内置简单数据类型、其它自定义的struct类型、当前struct类型本身、接口、函数、channel等等, 如果某几个字段类型相同，可以缩写在同一行：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name, City <span class="keyword">string</span></span><br><span class="line">    Age <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以看出结构体就像一个容器，这个容器里面装什么由我们自己定义, 这也是结构体的特点: 自定义化的程度很高, 使用灵活</p>
<h2 id="构造结构体实例"><a href="#构造结构体实例" class="headerlink" title="构造结构体实例"></a>构造结构体实例</h2><p>定义了struct，就表示定义了一个数据结构，或者说数据类型，也或者说定义了一个类。总而言之，定义了struct，就具备了成员属性，就可以作为一个抽象的模板，可以根据这个抽象模板生成具体的实例，也就是所谓的”对象”, 也就是面向对象中的 Class —&gt; Object, 如下图:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Waylonwhynot/whatyouneed_blog_pic@main/pic/class-object.png" alt="img"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Car <span class="keyword">struct</span> &#123;</span><br><span class="line">    Color <span class="keyword">string</span>  <span class="comment">// 颜色</span></span><br><span class="line">    Brand <span class="keyword">string</span>  <span class="comment">// 品牌</span></span><br><span class="line">    Model <span class="keyword">string</span>  <span class="comment">// 型号</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> car Car   <span class="comment">// 初始化一个Car实例, car就代表是一辆具体的车(Object)</span></span><br></pre></td></tr></table></figure>

<p>这里的car就是一个具体的Car实例，它根据抽象的模板Car构造而出，具有具体的属性Color,Brand和Model的值，虽然初始化时它的各个字段都是””值。换句话说，car是一个具体的车, 比如福特野马</p>
<p>struct初始化时，会做默认的赋0初始化，会给它的每个字段根据它们的数据类型赋予对应的0值。例如int类型是数值0，string类型是””，引用类型是nil等</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> car Car</span><br><span class="line">fmt.Printf(<span class="string">&quot;%+v&quot;</span>, car) <span class="comment">// &#123;Color: Brand: Model:&#125;</span></span><br></pre></td></tr></table></figure>

<p>我们也可以在声明的时候直接为成员变量赋值，我们通常把这个过程称之为构造结构体的实例, 语法如下:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 我们使用&#123;k:v, k:v&#125;这种方式来为结构体的成员赋值</span></span><br><span class="line">TypeName&#123;filed1: value1, filed2: value2, ...&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为了书写美观, 我们通常都把每一个k:v 独立写在一行，比如:</span></span><br><span class="line">TypeName&#123;</span><br><span class="line">    file1: value1,</span><br><span class="line">    file2: value2,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面我们看一个具体的例子，比如我们要通过Car构造一个具体的汽车: 福特野马</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为了书写的简洁，我们采用简单声明的方式, 就像 a := 10 &lt;---&gt;  var a int; a = 10</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">var</span> car Car</span><br><span class="line">fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, car)</span><br><span class="line"></span><br><span class="line">car = Car&#123;</span><br><span class="line">  <span class="comment">// 当然你也可以不然声明car的类型, 直接使用简短声明: car := Car&#123;...&#125;</span></span><br><span class="line">    Color: <span class="string">&quot;yellow&quot;</span>, <span class="comment">// 黄色</span></span><br><span class="line">    Brand: <span class="string">&quot;ford&quot;</span>,   <span class="comment">// 福特</span></span><br><span class="line">    Model: <span class="string">&quot;yema&quot;</span>,   <span class="comment">// 请原谅我的无知, 不知道野马用英语怎么表达</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;%+v\n&quot;</span>, car) <span class="comment">// &#123;Color:yellow Brand:ford Model:yema&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意，上面最后一个逗号&quot;,&quot;不能省略，Go会报错，这个逗号有助于我们去扩展这个结构</span></span><br></pre></td></tr></table></figure>

<h2 id="属性的访问和修改"><a href="#属性的访问和修改" class="headerlink" title="属性的访问和修改"></a>属性的访问和修改</h2><p>因为car已经是初始化Car之后的实例了，它已经具备了实实在在存在的属性(即字段)，所以可以直接访问它的各个属性,具体语法如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结构体.成员名</span><br></pre></td></tr></table></figure>

<p>比如我们可以打印下这个汽车的颜色和品牌:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(car.Color, car.Brand, car.Model) &#x2F;&#x2F; yellow ford yema</span><br></pre></td></tr></table></figure>

<p>我们也可以通过赋值操作来修改这些字段（成员变量的值), 我们换一辆大众高尔夫来试试</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">car.Color = <span class="string">&quot;green&quot;</span> </span><br><span class="line">car.Brand = <span class="string">&quot;Volkswagen&quot;</span></span><br><span class="line">car.Model = <span class="string">&quot;golf&quot;</span></span><br><span class="line">fmt.Println(car.Color, car.Brand, car.Model) <span class="comment">// green Volkswagen golf</span></span><br></pre></td></tr></table></figure>

<h2 id="结构体指针"><a href="#结构体指针" class="headerlink" title="结构体指针"></a>结构体指针</h2><p>如果我们要把这个结构体的实例传给一个函数修改，比如改变它的颜色:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给车换一个颜色，喷成蓝色</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ChangeColor</span><span class="params">(car Car)</span></span> &#123;</span><br><span class="line">    car.Color = <span class="string">&quot;blue&quot;</span></span><br><span class="line">    fmt.Println(car.Color)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    car := Car&#123;</span><br><span class="line">        Color: <span class="string">&quot;yellow&quot;</span>, <span class="comment">// 黄色</span></span><br><span class="line">        Brand: <span class="string">&quot;ford&quot;</span>,   <span class="comment">// 福特</span></span><br><span class="line">        Model: <span class="string">&quot;yema&quot;</span>,   <span class="comment">// 请原谅我的无知, 不知道野马用英语怎么表达</span></span><br><span class="line">    &#125;</span><br><span class="line">    ChangeToW(car)</span><br><span class="line">    fmt.Println(car.Color) <span class="comment">// yellow</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为什么我们并没有修改到这辆车的颜色? 大家思想下 指针 和 值的区别 (值传递与引用传递)</p>
<p>答案是: Go函数给参数传递值的时候是以复制的方式进行的。</p>
<h3 id="结构体指针声明与初始化"><a href="#结构体指针声明与初始化" class="headerlink" title="结构体指针声明与初始化"></a>结构体指针声明与初始化</h3><p>1.声明结构体指针</p>
<p>和其他基础数据类型一样，我们也可声明结构体指针变量，此时变量被初始化为 nil</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> car *Car</span><br><span class="line">fmt.Println(car)</span><br><span class="line"><span class="comment">// &lt;nil&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.声明并初始化一个结构体指针</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">car := &amp;Car&#123;</span><br><span class="line">    Color: <span class="string">&quot;yellow&quot;</span>, <span class="comment">// 黄色</span></span><br><span class="line">    Brand: <span class="string">&quot;ford&quot;</span>,   <span class="comment">// 福特</span></span><br><span class="line">    Model: <span class="string">&quot;yema&quot;</span>,   <span class="comment">// 请原谅我的无知, 不知道野马用英语怎么表达</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;%p&quot;</span>, car)</span><br></pre></td></tr></table></figure>

<p>3.new函数创建指针对象</p>
<p>Go 语言中常定义 N(n)ew+结构体名命名的函数用于创建对应的结构体值对象或指针对象</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">car := <span class="built_in">new</span>(Car)</span><br><span class="line">fmt.Printf(<span class="string">&quot;%p&quot;</span>, car)</span><br></pre></td></tr></table></figure>

<h3 id="传递结构体指针"><a href="#传递结构体指针" class="headerlink" title="传递结构体指针"></a>传递结构体指针</h3><p>我们可以改造下, 将一个结构体的指针传递给函数，看能否修改到该结构体</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ChangeColor</span><span class="params">(car *Car)</span></span> &#123;</span><br><span class="line">    car.Color = <span class="string">&quot;blue&quot;</span></span><br><span class="line">    fmt.Println(car.Color)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    car := Car&#123;</span><br><span class="line">        Color: <span class="string">&quot;yellow&quot;</span>, <span class="comment">// 黄色</span></span><br><span class="line">        Brand: <span class="string">&quot;ford&quot;</span>,   <span class="comment">// 福特</span></span><br><span class="line">        Model: <span class="string">&quot;yema&quot;</span>,   <span class="comment">// 请原谅我的无知, 不知道野马用英语怎么表达</span></span><br><span class="line">    &#125;</span><br><span class="line">    ChangeToW(car)</span><br><span class="line">    fmt.Println(car.Color) <span class="comment">// blue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到我们可以修改该实例对象了</p>
<h3 id="结构体值与结构体指针"><a href="#结构体值与结构体指针" class="headerlink" title="结构体值与结构体指针"></a>结构体值与结构体指针</h3><p>先思考2个问题:</p>
<ul>
<li>什么是值？</li>
<li>什么是指针?</li>
</ul>
<p>下面三种方式都可以构造Car struct的实例c:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c1 := Car&#123;&#125;</span><br><span class="line">c2 := &amp;Car&#123;&#125;</span><br><span class="line">c3 := <span class="built_in">new</span>(Car)</span><br><span class="line">fmt.Println(c1, c2, c3) <span class="comment">// &#123;  &#125; &amp;&#123;  &#125; &amp;&#123;  &#125;</span></span><br></pre></td></tr></table></figure>

<p>c1、c2、c3都是person struct的实例，c2, c3是指向实例的指针，指针中保存的是实例的地址，所以指针再指向实例，c1则是直接指向实例。这三个变量与Car struct实例的指向关系如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">变量名      指针     数据对象(实例)</span><br><span class="line">-------------------------------</span><br><span class="line">c1 -------------------&gt; &#123; &#125;</span><br><span class="line">c2 -----&gt; ptr(addr) --&gt; &#123; &#125;</span><br><span class="line">c3 -----&gt; ptr(addr) --&gt; &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>那访问实例和访问实例指针有区别吗?</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;c1, &quot;</span>, c1.Color)    <span class="comment">// 访问实例的属性</span></span><br><span class="line">fmt.Println(<span class="string">&quot;c2, &quot;</span>, (*c2).Color) <span class="comment">// 先通过*求出 指针的值，就是实例的内存地址, 然后通过实例的内存地址访问该实例对象的属性</span></span><br></pre></td></tr></table></figure>

<p>如果我们需要访问指针对象的属性, 上面的(*c2).Color 是理论上正确写法, 可以看出过于繁琐, 而我们方法指针，往往也是想访问这个指针的实例, 所以编译帮我们做了优化, 比如访问指针实例也可以这样写:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;c2, &quot;</span>, c2.Color) <span class="comment">// 编译器帮你补充上(*c2).Color, 这样写法上就简洁了</span></span><br></pre></td></tr></table></figure>

<p>简单总结下: 尽管一个是数据对象值，一个是指针，它们都是数据对象的实例。也就是说，p1.name和p2.name都能访问对应实例的属性, 只是指针的访问写法是一种简写(正确写法由编译器补充)</p>
<h3 id="传值-Or-传递指针"><a href="#传值-Or-传递指针" class="headerlink" title="传值 Or 传递指针"></a>传值 Or 传递指针</h3><p>那我们什么时候传值, 什么时候传递指针喃?</p>
<ul>
<li>传递值: 当我们不希望我们的实例被外部修改的时候，传值就相当于copy了一份副本给函数(这个成立是有条件的？ 思考下条件是啥)</li>
<li>传递指针: 当我们希望外部能修改到这个实例本身的时候，就需要传递该实例的指针, 就是把该实例的内存地址告诉对方, 可以通过地址直接找到本体</li>
</ul>
<p>但是我们经常看到函数接收的结构体参数都是指针，这是为什么喃?</p>
<p>复制传值时，如果函数的参数是一个struct对象，将直接复制整个数据结构的副本传递给函数，这有两个问题：</p>
<ul>
<li>函数内部无法修改传递给函数的原始数据结构，它修改的只是原始数据结构拷贝后的副本</li>
<li>如果传递的原始数据结构很大，完整地复制出一个副本开销并不小</li>
</ul>
<p>所以我们为了节省开销一般都会选择传递指针。</p>
<h2 id="结构体方法"><a href="#结构体方法" class="headerlink" title="结构体方法"></a>结构体方法</h2><p>Go中也有方法，它是一种特殊的函数，定义于struct之上(与struct关联、绑定)，被称为struct的receiver</p>
<p>它的定义方式大致如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> mytype <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r mytype)</span> <span class="title">my_method</span><span class="params">(para)</span> <span class="title">return_type</span></span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>属于数据结构的函数叫做结构体的方法, 我们可以对比下 属于结构体的函数 与 普通函数的 声明区别:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">functionName</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构体方法的定义</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t  TypeName)</span> <span class="title">functionName</span><span class="params">()</span></span> &#123;&#125;</span><br><span class="line"><span class="comment">// func               是关键字</span></span><br><span class="line"><span class="comment">// t                  是类型的缩写, 我们可以通过t.filed 的方式访问到这个结构的所有成员变量</span></span><br><span class="line"><span class="comment">// TypeName           结构体类型名称 </span></span><br><span class="line"><span class="comment">// functioonName() &#123;&#125; 函数签名</span></span><br></pre></td></tr></table></figure>

<p>我们可以看到结构体方法相比于 普通的函数就是多了一个这个: (t TypeName)</p>
<h2 id="结构体嵌套"><a href="#结构体嵌套" class="headerlink" title="结构体嵌套"></a>结构体嵌套</h2><p>复杂从此开始</p>
<ul>
<li><p>匿名字段：顾名思义，就是没有字段名只有类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> test <span class="keyword">struct</span> &#123;</span><br><span class="line">  name <span class="keyword">string</span></span><br><span class="line">  age <span class="keyword">int</span></span><br><span class="line">  <span class="keyword">int</span> <span class="comment">// 匿名字段</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>为啥要有匿名字段，就是模仿面向对象中的继承</li>
</ul>
</li>
<li><p>匿名结构体（也叫内嵌结构体）</p>
</li>
</ul>
<ol>
<li>匿名嵌套(嵌入的结构体无字段名)</li>
</ol>
<blockquote>
<p>在定义变量时将类型指定为结构体的结构，此时叫匿名结构体。匿名结构体常用于初始化一 次结构体变量的场景，例如项目配置</p>
</blockquote>
<p>匿名结构体可以组合不同类型的数据，使得处理数据变得更为灵活。尤其是在一些需要将多个变量、类型数据组合应用的场景，匿名结构体是一个不错的选择</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">    Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Teacher <span class="keyword">struct</span> &#123;</span><br><span class="line">    Person</span><br><span class="line">    TeacherId <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    t1 := Teacher&#123;</span><br><span class="line">        Person: Person&#123;</span><br><span class="line">            Name: <span class="string">&quot;Waylon&quot;</span>,</span><br><span class="line">            Age:  <span class="number">18</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        TeacherId: <span class="number">123</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">结构体.成员名</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">//定义手机屏幕</span></span><br><span class="line"><span class="keyword">type</span> Screen01 <span class="keyword">struct</span> &#123;</span><br><span class="line">    Size       <span class="keyword">float64</span> <span class="comment">//屏幕尺寸</span></span><br><span class="line">    ResX, ResY <span class="keyword">int</span> <span class="comment">//屏幕分辨率 水平 垂直</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义电池容量</span></span><br><span class="line"><span class="keyword">type</span> Battery <span class="keyword">struct</span> &#123;</span><br><span class="line">    Capacity <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//返回json数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getJsonData</span><span class="params">()</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">    <span class="comment">//tempData 接收匿名结构体（匿名结构体使得数据的结构更加灵活）</span></span><br><span class="line">    tempData := <span class="keyword">struct</span> &#123;</span><br><span class="line">        Screen01</span><br><span class="line">        Battery</span><br><span class="line">        HashTouchId <span class="keyword">bool</span>  <span class="comment">// 是否有指纹识别</span></span><br><span class="line">    &#125;&#123;</span><br><span class="line">        Screen01:    Screen01&#123;Size: <span class="number">12</span>, ResX: <span class="number">36</span>, ResY: <span class="number">36</span>&#125;,</span><br><span class="line">        Battery:     Battery&#123;<span class="string">&quot;6000毫安&quot;</span>&#125;,</span><br><span class="line">        HashTouchId: <span class="literal">true</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    jsonData, _ := json.Marshal(tempData)  <span class="comment">//将数据转换为json</span></span><br><span class="line">    <span class="keyword">return</span> jsonData</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>命名嵌套</li>
</ol>
<p>结构体命名嵌入是指结构体中的属性对应的类型也是结构体</p>
<p>适用于复合数据结构&lt;嵌入匿名&gt;</p>
<ul>
<li>定义</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Book <span class="keyword">struct</span> &#123;</span><br><span class="line">    Author  <span class="keyword">struct</span>&#123;</span><br><span class="line">        Name <span class="keyword">string</span></span><br><span class="line">        Aage <span class="keyword">int</span></span><br><span class="line">    &#125;</span><br><span class="line">    Title <span class="keyword">struct</span>&#123;</span><br><span class="line">        Main <span class="keyword">string</span> </span><br><span class="line">        Sub  <span class="keyword">string</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>声明和初始化</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">b := &amp;Book&#123;</span><br><span class="line">    Author: <span class="keyword">struct</span> &#123;</span><br><span class="line">        Name <span class="keyword">string</span></span><br><span class="line">        Aage <span class="keyword">int</span></span><br><span class="line">    &#125;&#123;</span><br><span class="line">        Name: <span class="string">&quot;xxxx&quot;</span>,</span><br><span class="line">        Aage: <span class="number">11</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Title: <span class="keyword">struct</span> &#123;</span><br><span class="line">        Main <span class="keyword">string</span></span><br><span class="line">        Sub  <span class="keyword">string</span></span><br><span class="line">    &#125;&#123;</span><br><span class="line">        Main: <span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">        Sub:  <span class="string">&quot;yyy&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不会有人愿意那样用的</span></span><br><span class="line">b := <span class="built_in">new</span>(Book)</span><br><span class="line">b.Author.Aage = <span class="number">11</span></span><br><span class="line">b.Author.Name = <span class="string">&quot;xxx&quot;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>命名嵌入</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Author <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">    Aage <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Title <span class="keyword">struct</span> &#123;</span><br><span class="line">    Main <span class="keyword">string</span></span><br><span class="line">    Sub  <span class="keyword">string</span>    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Book <span class="keyword">struct</span> &#123;</span><br><span class="line">    Au Author</span><br><span class="line">    Ti Title</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>声明</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">b := &amp;Book&#123;</span><br><span class="line">    Au: Author&#123;</span><br><span class="line">        Name: <span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">        Aage: <span class="number">11</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Ti: Title&#123;</span><br><span class="line">        Main: <span class="string">&quot;t1&quot;</span>,</span><br><span class="line">        Sub:  <span class="string">&quot;t2&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>属性的访问和修改</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b.Au.Name &#x3D; &quot;xxx&quot;</span><br></pre></td></tr></table></figure>

<h2 id="结构体的组合-嵌入"><a href="#结构体的组合-嵌入" class="headerlink" title="结构体的组合: 嵌入"></a>结构体的组合: 嵌入</h2><blockquote>
<p><strong>可以理解为继承</strong></p>
<p><strong>生产意义：</strong></p>
<ol>
<li>项目中复杂的配置文件<ul>
<li>公共的字段，抽取出来，放到一个common的结构体</li>
</ul>
</li>
<li>cmdb、资产系统：ecs云主机、rds关系型数据库、elb负载均衡器<ul>
<li>公共的字段可以出去出来，放到一个公共的结构体；特有字段放到新的结构体，然后嵌入公共结构体</li>
</ul>
</li>
</ol>
</blockquote>
<p>1.匿名嵌入</p>
<p>结构体匿名嵌入是指将已定义的结构体名直接声明在新的结构体中，从而实现对以后已有类 型的扩展和修改</p>
<ol>
<li>定义</li>
<li>声明&amp;初始化</li>
<li>属性访问和修改</li>
</ol>
<p>2.指针类型嵌入</p>
<ol>
<li><p>定义</p>
</li>
<li><p>声明&amp;初始化&amp;操作</p>
</li>
</ol>
<h2 id="可见性"><a href="#可见性" class="headerlink" title="可见性"></a>可见性</h2><p>结构体首字母大写则包外可见(公开的)，否者仅包内可访问(内部的) 结构体属性名首字母大写包外可见(公开的)，否者仅包内可访问(内部的) 组合：</p>
<ul>
<li>结构体名首字母大写，属性名大写：结构体可在包外使用，且访问其大写的属性名</li>
<li>结构体名首字母大写，属性名小写：结构体可在包外使用，且不能访问其小写的属性名</li>
<li>结构体名首字母小写，属性名大写：结构体只能在包内使用，属性访问在结构体嵌入时 由被嵌入结构体(外层)决定，被嵌入结构体名首字母大写时属性名包外可见，否者只能 在包内使用</li>
<li>结构体名首字母小写，属性名小写：结构体只能在包内使用</li>
</ul>
<h2 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h2><blockquote>
<p>有时候 为了不让对象直接相互干扰, 我们需要深度赋值对象</p>
</blockquote>
<h4 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a><strong>浅拷贝</strong></h4><p><strong>引用类型的数据，默认都是浅拷贝</strong></p>
<ul>
<li>slice map funtion</li>
<li>新老对象指向同一块内存区域</li>
<li>a修改字段，b中字段也跟着改变了</li>
<li>内存销毁是一致的</li>
</ul>
<h4 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a><strong>深拷贝</strong></h4><p><strong>值类型的数据，默认都是深拷贝</strong></p>
<ul>
<li><p>int float string bool array struct</p>
</li>
<li><p>复制的时候，会创建一个对象</p>
</li>
<li><p>指向完全不同的内存地址</p>
</li>
<li><p>修改是互不影响的</p>
</li>
</ul>
<h4 id="（1）结构体基础字段浅拷贝手段1：使用指针"><a href="#（1）结构体基础字段浅拷贝手段1：使用指针" class="headerlink" title="（1）结构体基础字段浅拷贝手段1：使用指针"></a>（1）结构体基础字段浅拷贝手段1：使用指针</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Per <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">    Age <span class="keyword">int</span></span><br><span class="line">    HouseIds [<span class="number">2</span>]<span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    p1 := Per&#123;</span><br><span class="line">        Name:     <span class="string">&quot;xiaoyi&quot;</span>,</span><br><span class="line">        Age:      <span class="number">18</span>,</span><br><span class="line">        HouseIds: [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">22</span>,<span class="number">33</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    p2 := &amp;p1</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, &amp;p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">    p2.HouseIds = [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">44</span>, <span class="number">55</span>&#125;</span><br><span class="line">    p2.Name = <span class="string">&quot;heihei&quot;</span></span><br><span class="line">    p2.Age = <span class="number">111</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, &amp;p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[p1 value: &#123;xiaoyi <span class="number">18</span> [<span class="number">22</span> <span class="number">33</span>]&#125;]  [p1 point: <span class="number">0xc000074180</span>]</span><br><span class="line">[p2 value: &amp;&#123;xiaoyi <span class="number">18</span> [<span class="number">22</span> <span class="number">33</span>]&#125;]         [p2 point: <span class="number">0xc000074180</span>]</span><br><span class="line">[p1 value: &#123;heihei <span class="number">111</span> [<span class="number">44</span> <span class="number">55</span>]&#125;]         [p1 point: <span class="number">0xc000074180</span>]</span><br><span class="line">[p2 value: &amp;&#123;heihei <span class="number">111</span> [<span class="number">44</span> <span class="number">55</span>]&#125;]        [p2 point: <span class="number">0xc000074180</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（2）结构体基础字段浅拷贝手段2：使用new函数"><a href="#（2）结构体基础字段浅拷贝手段2：使用new函数" class="headerlink" title="（2）结构体基础字段浅拷贝手段2：使用new函数"></a>（2）结构体基础字段浅拷贝手段2：使用new函数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Per <span class="keyword">struct</span> &#123;</span><br><span class="line">   Name <span class="keyword">string</span></span><br><span class="line">   Age <span class="keyword">int</span></span><br><span class="line">   HouseIds [<span class="number">2</span>]<span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">   p1 := <span class="built_in">new</span>(Per)</span><br><span class="line">   p1.Name = <span class="string">&quot;Waylon&quot;</span></span><br><span class="line">   p1.Age = <span class="number">29</span></span><br><span class="line">   p1.HouseIds = [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">11</span>,<span class="number">22</span>&#125;</span><br><span class="line">   p2 := p1</span><br><span class="line">   fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">   fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">   p2.HouseIds = [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">44</span>, <span class="number">55</span>&#125;</span><br><span class="line">   p2.Name = <span class="string">&quot;heihei&quot;</span></span><br><span class="line">   p2.Age = <span class="number">111</span></span><br><span class="line">   fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">   fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[p1 value: &amp;&#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>]&#125;]         [p1 point: <span class="number">0xc000074180</span>]</span><br><span class="line">[p2 value: &amp;&#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>]&#125;]         [p2 point: <span class="number">0xc000074180</span>]</span><br><span class="line">[p1 value: &amp;&#123;heihei <span class="number">111</span> [<span class="number">44</span> <span class="number">55</span>]&#125;]        [p1 point: <span class="number">0xc000074180</span>]</span><br><span class="line">[p2 value: &amp;&#123;heihei <span class="number">111</span> [<span class="number">44</span> <span class="number">55</span>]&#125;]        [p2 point: <span class="number">0xc000074180</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（3）结构体中含有引用类型的字段"><a href="#（3）结构体中含有引用类型的字段" class="headerlink" title="（3）结构体中含有引用类型的字段"></a>（3）结构体中含有引用类型的字段</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Per <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">    Age <span class="keyword">int</span></span><br><span class="line">    HouseIds [<span class="number">2</span>]<span class="keyword">int</span></span><br><span class="line">    CarIds []<span class="keyword">int</span> <span class="comment">// 切片;浅拷贝</span></span><br><span class="line">    Labels <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> <span class="comment">// 上3都是值类型，深拷贝；map是引用类型,浅拷贝</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    p1 := Per&#123;</span><br><span class="line">        Name:     <span class="string">&quot;Waylon&quot;</span>,</span><br><span class="line">        Age:      <span class="number">29</span>,</span><br><span class="line">        HouseIds: [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">11</span>,<span class="number">22</span>&#125;,</span><br><span class="line">        CarIds: []<span class="keyword">int</span>&#123;<span class="number">911</span>, <span class="number">918</span>&#125;,</span><br><span class="line">        Labels:   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;k1&quot;</span>: <span class="string">&quot;v1&quot;</span>, <span class="string">&quot;k2&quot;</span>: <span class="string">&quot;v2&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    p2 := p1</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">    p2.HouseIds = [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">44</span>, <span class="number">55</span>&#125;</span><br><span class="line">    p2.Name = <span class="string">&quot;heihei&quot;</span></span><br><span class="line">    p2.Age = <span class="number">111</span></span><br><span class="line">    p2.CarIds[<span class="number">0</span>] = <span class="number">119</span></span><br><span class="line">    p2.Labels[<span class="string">&quot;k1&quot;</span>] = <span class="string">&quot;m1&quot;</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[p1 value: &#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>] [<span class="number">911</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:v1 k2:v2]&#125;]       [p1 point: %!p(main.Per=&#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>] [<span class="number">911</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:v1 k2:v2]&#125;)]</span><br><span class="line">[p2 value: &#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>] [<span class="number">911</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:v1 k2:v2]&#125;]       [p2 point: %!p(main.Per=&#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>] [<span class="number">911</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:v1 k2:v2]&#125;)]</span><br><span class="line">[p1 value: &#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>] [<span class="number">119</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:m1 k2:v2]&#125;]       [p1 point: %!p(main.Per=&#123;Waylon <span class="number">29</span> [<span class="number">11</span> <span class="number">22</span>] [<span class="number">119</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:m1 k2:v2]&#125;)]</span><br><span class="line">[p2 value: &#123;heihei <span class="number">111</span> [<span class="number">44</span> <span class="number">55</span>] [<span class="number">119</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:m1 k2:v2]&#125;]      [p2 point: %!p(main.Per=&#123;heihei <span class="number">111</span> [<span class="number">44</span> <span class="number">55</span>] [<span class="number">119</span> <span class="number">918</span>] <span class="keyword">map</span>[k1:m1 k2:v2]&#125;)]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（3）解决方案；希望是深拷贝"><a href="#（3）解决方案；希望是深拷贝" class="headerlink" title="（3）解决方案；希望是深拷贝"></a>（3）解决方案；希望是深拷贝</h4><p>方法1：挨个可导致引用类型的字段自行赋值</p>
<p>p2.Labels = map[string]string{“k1”: “v9”, “k2”: “v9”}</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    p1 := Per&#123;</span><br><span class="line">        Name:     <span class="string">&quot;Waylon&quot;</span>,</span><br><span class="line">        Age:      <span class="number">29</span>,</span><br><span class="line">        HouseIds: [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">11</span>,<span class="number">22</span>&#125;,</span><br><span class="line">        CarIds: []<span class="keyword">int</span>&#123;<span class="number">911</span>, <span class="number">918</span>&#125;,</span><br><span class="line">        Labels:   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;k1&quot;</span>: <span class="string">&quot;v1&quot;</span>, <span class="string">&quot;k2&quot;</span>: <span class="string">&quot;v2&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    p2 := p1</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">    p2.HouseIds = [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">44</span>, <span class="number">55</span>&#125;</span><br><span class="line">    p2.Name = <span class="string">&quot;heihei&quot;</span></span><br><span class="line">    p2.Age = <span class="number">111</span></span><br><span class="line">    p2.CarIds[<span class="number">0</span>] = <span class="number">119</span></span><br><span class="line">    p2.Labels = <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;k1&quot;</span>: <span class="string">&quot;v9&quot;</span>, <span class="string">&quot;k2&quot;</span>: <span class="string">&quot;v9&quot;</span>&#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法2：使用json</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    p1 := Per&#123;</span><br><span class="line">        Name:     <span class="string">&quot;Waylon&quot;</span>,</span><br><span class="line">        Age:      <span class="number">29</span>,</span><br><span class="line">        HouseIds: [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">11</span>,<span class="number">22</span>&#125;,</span><br><span class="line">        CarIds: []<span class="keyword">int</span>&#123;<span class="number">911</span>, <span class="number">918</span>&#125;,</span><br><span class="line">        Labels:   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;k1&quot;</span>: <span class="string">&quot;v1&quot;</span>, <span class="string">&quot;k2&quot;</span>: <span class="string">&quot;v2&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    data, _ := json.Marshal(p1)</span><br><span class="line">    <span class="keyword">var</span> p2 Per</span><br><span class="line">    json.Unmarshal(data, &amp;p2)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">    <span class="comment">//p2.HouseIds = [2]int&#123;44, 55&#125;</span></span><br><span class="line">    p2.Name = <span class="string">&quot;heihei&quot;</span></span><br><span class="line">    p2.Age = <span class="number">111</span></span><br><span class="line">    p2.CarIds[<span class="number">0</span>] = <span class="number">119</span></span><br><span class="line">    <span class="comment">//p2.Labels = map[string]string&#123;&quot;k1&quot;: &quot;v9&quot;, &quot;k2&quot;: &quot;v9&quot;&#125;</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p1 value: %v]\t [p1 point: %p]\n&quot;</span>, p1, p1)</span><br><span class="line">    fmt.Printf(<span class="string">&quot;[p2 value: %v]\t [p2 point: %p]\n&quot;</span>, p2, p2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="结构体字段的内存对齐"><a href="#结构体字段的内存对齐" class="headerlink" title="结构体字段的内存对齐"></a>结构体字段的内存对齐</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">    a <span class="keyword">bool</span></span><br><span class="line">    b <span class="keyword">int32</span></span><br><span class="line">    c <span class="keyword">string</span></span><br><span class="line">    d <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">    b <span class="keyword">int32</span></span><br><span class="line">    c <span class="keyword">string</span></span><br><span class="line">    d <span class="keyword">string</span></span><br><span class="line">    a <span class="keyword">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestStructSize</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    fmt.Println(unsafe.Sizeof(A&#123;&#125;))  <span class="comment">// 多少</span></span><br><span class="line">    fmt.Println(unsafe.Sizeof(B&#123;&#125;))  <span class="comment">// 多少</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Waylonwhynot/whatyouneed_blog_pic@main/pic/struct_size_01.png" alt="struct_size_01"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Waylonwhynot/whatyouneed_blog_pic@main/pic/struct_size_02.png" alt="struct_size_02"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Waylon Yan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/posts/18723.html">http://yoursite.com/posts/18723.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Go/">Go</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/59703.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Go-15-时间</div></div></a></div><div class="next-post pull-right"><a href="/posts/31621.html"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Go-12-函数</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/23007.html" title="Go-03-变量"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-18</div><div class="title">Go-03-变量</div></div></a></div><div><a href="/posts/52365.html" title="Go-02-基础入门"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-18</div><div class="title">Go-02-基础入门</div></div></a></div><div><a href="/posts/25552.html" title="Go-05-运算符"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-18</div><div class="title">Go-05-运算符</div></div></a></div><div><a href="/posts/13299.html" title="Go-06-String类型"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-19</div><div class="title">Go-06-String类型</div></div></a></div><div><a href="/posts/8146.html" title="Go-07-指针"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-19</div><div class="title">Go-07-指针</div></div></a></div><div><a href="/posts/39356.html" title="Go-07-数据类型转换"><img class="cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-21</div><div class="title">Go-07-数据类型转换</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Waylon Yan</div><div class="author-info__description">tech life sharing</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">266</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">40</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">25</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Waylonwhynot" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:ywl1006@outlook.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">无止境</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Go%E8%AF%AD%E8%A8%80%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">1.</span> <span class="toc-text">Go语言结构体</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.</span> <span class="toc-text">结构体的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E7%BB%93%E6%9E%84%E4%BD%93%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.2.</span> <span class="toc-text">构造结构体实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E8%AE%BF%E9%97%AE%E5%92%8C%E4%BF%AE%E6%94%B9"><span class="toc-number">1.3.</span> <span class="toc-text">属性的访问和修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88"><span class="toc-number">1.4.</span> <span class="toc-text">结构体指针</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88%E5%A3%B0%E6%98%8E%E4%B8%8E%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.4.1.</span> <span class="toc-text">结构体指针声明与初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88"><span class="toc-number">1.4.2.</span> <span class="toc-text">传递结构体指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%80%BC%E4%B8%8E%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88"><span class="toc-number">1.4.3.</span> <span class="toc-text">结构体值与结构体指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E5%80%BC-Or-%E4%BC%A0%E9%80%92%E6%8C%87%E9%92%88"><span class="toc-number">1.4.4.</span> <span class="toc-text">传值 Or 传递指针</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%96%B9%E6%B3%95"><span class="toc-number">1.5.</span> <span class="toc-text">结构体方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%B5%8C%E5%A5%97"><span class="toc-number">1.6.</span> <span class="toc-text">结构体嵌套</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E7%BB%84%E5%90%88-%E5%B5%8C%E5%85%A5"><span class="toc-number">1.7.</span> <span class="toc-text">结构体的组合: 嵌入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E8%A7%81%E6%80%A7"><span class="toc-number">1.8.</span> <span class="toc-text">可见性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.9.</span> <span class="toc-text">拷贝</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.9.0.1.</span> <span class="toc-text">浅拷贝</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.9.0.2.</span> <span class="toc-text">深拷贝</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E7%BB%93%E6%9E%84%E4%BD%93%E5%9F%BA%E7%A1%80%E5%AD%97%E6%AE%B5%E6%B5%85%E6%8B%B7%E8%B4%9D%E6%89%8B%E6%AE%B51%EF%BC%9A%E4%BD%BF%E7%94%A8%E6%8C%87%E9%92%88"><span class="toc-number">1.9.0.3.</span> <span class="toc-text">（1）结构体基础字段浅拷贝手段1：使用指针</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%BB%93%E6%9E%84%E4%BD%93%E5%9F%BA%E7%A1%80%E5%AD%97%E6%AE%B5%E6%B5%85%E6%8B%B7%E8%B4%9D%E6%89%8B%E6%AE%B52%EF%BC%9A%E4%BD%BF%E7%94%A8new%E5%87%BD%E6%95%B0"><span class="toc-number">1.9.0.4.</span> <span class="toc-text">（2）结构体基础字段浅拷贝手段2：使用new函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD%E5%90%AB%E6%9C%89%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AD%97%E6%AE%B5"><span class="toc-number">1.9.0.5.</span> <span class="toc-text">（3）结构体中含有引用类型的字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9B%E5%B8%8C%E6%9C%9B%E6%98%AF%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.9.0.6.</span> <span class="toc-text">（3）解决方案；希望是深拷贝</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5%E7%9A%84%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90"><span class="toc-number">1.10.</span> <span class="toc-text">结构体字段的内存对齐</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/5677.html" title="AI-08-A2A"><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI-08-A2A"/></a><div class="content"><a class="title" href="/posts/5677.html" title="AI-08-A2A">AI-08-A2A</a><time datetime="2025-06-21T07:22:33.000Z" title="Created 2025-06-21 15:22:33">2025-06-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/18525.html" title="AI-07-MCP"><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI-07-MCP"/></a><div class="content"><a class="title" href="/posts/18525.html" title="AI-07-MCP">AI-07-MCP</a><time datetime="2025-06-08T06:19:30.000Z" title="Created 2025-06-08 14:19:30">2025-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/65143.html" title="AI-06-dify"><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI-06-dify"/></a><div class="content"><a class="title" href="/posts/65143.html" title="AI-06-dify">AI-06-dify</a><time datetime="2025-06-08T06:19:08.000Z" title="Created 2025-06-08 14:19:08">2025-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/45471.html" title="AI-05-coze"><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI-05-coze"/></a><div class="content"><a class="title" href="/posts/45471.html" title="AI-05-coze">AI-05-coze</a><time datetime="2025-05-17T15:16:48.000Z" title="Created 2025-05-17 23:16:48">2025-05-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/34613.html" title="AI-04-提示词工程"><img src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI-04-提示词工程"/></a><div class="content"><a class="title" href="/posts/34613.html" title="AI-04-提示词工程">AI-04-提示词工程</a><time datetime="2025-05-17T15:15:51.000Z" title="Created 2025-05-17 23:15:51">2025-05-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Waylon Yan</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>